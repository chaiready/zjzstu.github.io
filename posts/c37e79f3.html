<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.0.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="alternate" href="/./atom.xml" title="做一个幸福的人" type="application/atom+xml"><meta name="google-site-verification" content="Qr_3yqLtyErDFKHW7mE8PJz4qDUX-bf_fMLpSRckQe4"><meta name="baidu-site-verification" content="zOwIvKMV7f"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Roboto:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="/lib/pace/pace-theme-center-atom.min.css"><script src="/lib/pace/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"7.5.0",exturl:!1,sidebar:{position:"left",display:"post",offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!1,pangu:!1,algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"搜索文章",hits_empty:"我们没有找到任何搜索结果: ${query}",hits_stats:"找到约${hits}条结果（用时${time}ms）"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},translation:{copy_button:"复制",copy_success:"复制成功",copy_failure:"复制失败"},sidebarPadding:40}</script><link href="https://fonts.googleapis.com/css?family=Noto+Serif+SC|Roboto&display=swap" rel="stylesheet"><meta name="description" content="在分类问题上经常会遇到一个名词 - 决策边界。对它有一些了解但是没有很多的认识，同时很难直观去理解高维数据分类问题的决策边界"><meta name="keywords" content="python,numpy,matplotlib,sklearn,pandas"><meta property="og:type" content="article"><meta property="og:title" content="决策边界"><meta property="og:url" content="https:&#x2F;&#x2F;www.zhujian.tech&#x2F;posts&#x2F;c37e79f3.html"><meta property="og:site_name" content="做一个幸福的人"><meta property="og:description" content="在分类问题上经常会遇到一个名词 - 决策边界。对它有一些了解但是没有很多的认识，同时很难直观去理解高维数据分类问题的决策边界"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https:&#x2F;&#x2F;www.zhujian.tech&#x2F;imgs&#x2F;决策边界&#x2F;lr_decision_boundary.png"><meta property="og:image" content="https:&#x2F;&#x2F;www.zhujian.tech&#x2F;imgs&#x2F;决策边界&#x2F;nn_decision_boundary.png"><meta property="og:image" content="https:&#x2F;&#x2F;www.zhujian.tech&#x2F;imgs&#x2F;决策边界&#x2F;spiral_linear.png"><meta property="og:image" content="https:&#x2F;&#x2F;www.zhujian.tech&#x2F;imgs&#x2F;决策边界&#x2F;spiral_net.png"><meta property="og:image" content="https:&#x2F;&#x2F;www.zhujian.tech&#x2F;imgs&#x2F;决策边界&#x2F;nn_iris.png"><meta property="og:updated_time" content="2020-02-15T05:36:35.871Z"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https:&#x2F;&#x2F;www.zhujian.tech&#x2F;imgs&#x2F;决策边界&#x2F;lr_decision_boundary.png"><link rel="canonical" href="https://www.zhujian.tech/posts/c37e79f3.html"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,isPage:!1,isArchive:!1}</script><title>决策边界 | 做一个幸福的人</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?e677aac1ac69b8826b9cfecb4e72e107";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">做一个幸福的人</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">面朝大海，春暖花开</p></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签<span class="badge">129</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类<span class="badge">48</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档<span class="badge">169</span></a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header> <a href="https://github.com/zjZSTU" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.zhujian.tech/posts/c37e79f3.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.png"><meta itemprop="name" content="zhujian"><meta itemprop="description" content="one bite at a time"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="做一个幸福的人"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> 决策边界</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-07-18 19:08:52" itemprop="dateCreated datePublished" datetime="2019-07-18T19:08:52+00:00">2019-07-18</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-02-15 05:36:35" itemprop="dateModified" datetime="2020-02-15T05:36:35+00:00">2020-02-15</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/algorithm/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/programming/programming-language/" itemprop="url" rel="index"><span itemprop="name">编程语言</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/algorithm/data-learning/" itemprop="url" rel="index"><span itemprop="name">机器学习</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/programming/codebase/" itemprop="url" rel="index"><span itemprop="name">代码库</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">本文字数：</span> <span>8.3k</span></span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span>14 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><p>在分类问题上经常会遇到一个名词 - 决策边界。对它有一些了解但是没有很多的认识，同时很难直观去理解高维数据分类问题的决策边界</p><a id="more"></a><p>理清决策边界的概念，同时可视化决策边界</p><h2 id="什么是决策边界"><a href="#什么是决策边界" class="headerlink" title="什么是决策边界"></a>什么是决策边界</h2><p>参考：<a href="https://en.wikipedia.org/wiki/Decision_boundary" target="_blank" rel="noopener">Decision boundary</a></p><p>对于二分类问题，如果在向量空间中存在一个能够分类数据集的超曲面（<code>hypersurface</code>），使得同一类的数据点在超曲面的同一边，称该超曲面为决策边界（<code>decision boundary</code>）或决策曲面（<code>decision surface</code>）</p><h2 id="什么是超平面"><a href="#什么是超平面" class="headerlink" title="什么是超平面"></a>什么是超平面</h2><p>参考：</p><p><a href="https://baike.baidu.com/item/%E8%B6%85%E5%B9%B3%E9%9D%A2" target="_blank" rel="noopener">超平面</a></p><p><a href="https://blog.csdn.net/dengheCSDN/article/details/77313758" target="_blank" rel="noopener">超平面是什么？——理解超平面（SVM开篇之超平面详解）</a></p><p><a href="https://www.zhihu.com/question/24954154" target="_blank" rel="noopener">关于超平面的疑问?</a></p><p>超平面是维度比向量空间维度小<code>1</code>的线性子空间，比如<code>3</code>维向量空间的超平面是<code>2</code>维，<code>2</code>维向量空间的超平面是<code>1</code>维</p><p>超平面的另一种解释是它的自由度比向量空间维度小<code>1</code>，比如在<code>3</code>维向量空间的<code>2</code>维超平面上，给定<code>（x,y,z）</code>中的任意两点就能确定剩余一点的值</p><p>超平面的数学形式如下：</p><p>对于二维空间，超平面就是一条直线：$ax + by + c=0$</p><p>对于三维空间，超平面就是一个平面：$ax + by + cz + d = 0$</p><p>推广到$n$维空间：$ax + by + cz + … + x = 0$</p><p>简写成：$wX + b = 0$</p><h2 id="线性-vs-非线性"><a href="#线性-vs-非线性" class="headerlink" title="线性 vs. 非线性"></a>线性 vs. 非线性</h2><p>参考：<a href="https://www.zhihu.com/question/30633734" target="_blank" rel="noopener">线性分类器与非线性分类器的区别？</a></p><p>如果决策边界是一个超平面（<code>hyperplane</code>），那么称该分类问题为线性可分的，分类器是线性分类器（<code>linear classifier</code>），反之称之为非线性分类器（<code>nonlinear classifier</code>）</p><h3 id="常用线性和非线性分类器"><a href="#常用线性和非线性分类器" class="headerlink" title="常用线性和非线性分类器"></a>常用线性和非线性分类器</h3><p>线性分类器</p><ul><li>对于<strong>线性SVM分类器</strong>而言，其前向操作就是一个线性映射，所以它是线性分类器</li><li>对于<strong>逻辑回归分类器</strong>而言，其前向操作是线性映射+<code>sigmoid</code>函数，其是否线性判定比较复杂，参考<a href="https://www.zhihu.com/question/30726036" target="_blank" rel="noopener">logistic回归属于线性模型还是非线性模型？</a>，<strong>就我个人观察，虽然<code>sigmoid</code>操作增加了非线性因素，但通常以$p=0.5$作为分类面进行分类，也就是说，线性映射结果就决定了分类结果，那么可以看成是线性分类器</strong></li><li>对于<strong>softmax分类器</strong>而言，其是逻辑回归对于多分类问题的推广，参考<a href="http://cs231n.github.io/linear-classify/#softmax" target="_blank" rel="noopener">Softmax classifier</a>，同样可看成是线性分类器</li></ul><p>非线性分类器</p><ul><li>对于<strong>神经网络</strong>而言，如果没有隐藏层，那么就是一个线性分类器；如果有多个隐藏层就是非线性分类器</li><li>对于<strong>KNN分类器</strong>而言，其分类标准基于训练数据和测试数据的像素差异，不存在分类超平面，所以是非线性分类器</li></ul><h2 id="决策边界可视化"><a href="#决策边界可视化" class="headerlink" title="决策边界可视化"></a>决策边界可视化</h2><p>参考：</p><p><a href="https://www.devtalking.com/articles/machine-learning-11/" target="_blank" rel="noopener">机器学习笔记十一之决策边界</a></p><p><a href="http://blog.itpub.net/31545819/viewspace-2564384/" target="_blank" rel="noopener">决策边界可视化，让你的分类合理有序</a></p><p>可视化决策边界能够有助于算法的理解和改进，实现方式可分为两类：</p><ol><li><p>单线决策边界：使用一条数据线分隔不同类区域</p></li><li><p>基于轮廓的决策边界：利用不同颜色的轮廓包围数据点区域</p></li></ol><h3 id="单线决策边界"><a href="#单线决策边界" class="headerlink" title="单线决策边界"></a>单线决策边界</h3><p>这种方式适用于线性分类器，以逻辑回归分类器为例，其类实现地址：<a href="https://github.com/zjZSTU/cs231n/blob/master/coding/classifier/lr_classifier.py" target="_blank" rel="noopener">lr_classifier.py</a></p><p>数据集<code>scores.csv</code>包含<code>100</code>名学生在<code>2</code>次考试中获得的分数和标签，下载链接</p><ul><li><a href="https://github.com/navoneel1092283/logistic_regression.git" target="_blank" rel="noopener">https://github.com/navoneel1092283/logistic_regression.git</a></li><li><a href="https://download.csdn.net/download/u012005313/11384178" target="_blank" rel="noopener">https://download.csdn.net/download/u012005313/11384178</a></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"></span><br><span class="line"># @Time    : 19-7-18 下午8:51</span><br><span class="line"># @Author  : zj</span><br><span class="line"></span><br><span class="line">import numpy as np</span><br><span class="line">from sklearn.model_selection import train_test_split</span><br><span class="line">import pandas as pd</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">from lr_classifier import LogisticClassifier</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def load_scores(data_path, shuffle=True, tsize=0.8):</span><br><span class="line">    df = pd.read_csv(data_path, header=None, sep=&apos;,&apos;)</span><br><span class="line">    values = np.array(df.values)</span><br><span class="line">    x = values[:, :2]</span><br><span class="line">    y = values[:, 2]</span><br><span class="line"></span><br><span class="line">    x_train, x_test, y_train, y_test = train_test_split(x, y, shuffle=shuffle, train_size=tsize)</span><br><span class="line"></span><br><span class="line">    return x_train, x_test, y_train, y_test</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    scores_path = &apos;/home/zj/data/scores.csv&apos;</span><br><span class="line">    x_train, x_test, y_train, y_test = load_scores(scores_path)</span><br><span class="line"></span><br><span class="line">    # 零中心 + 单位方差</span><br><span class="line">    mu = np.mean(x_train, axis=0)</span><br><span class="line">    var = np.var(x_train, axis=0)</span><br><span class="line">    eps = 1e-5</span><br><span class="line">    x_train = (x_train - mu) / np.sqrt(var + eps)</span><br><span class="line">    x_test = (x_test - mu) / np.sqrt(var + eps)</span><br><span class="line"></span><br><span class="line">    # 训练分类器</span><br><span class="line">    classifier = LogisticClassifier()</span><br><span class="line">    classifier.train(x_train, y_train, num_iters=5000, batch_size=120, verbose=True)</span><br><span class="line"></span><br><span class="line">    # 编辑网络，预测结果</span><br><span class="line">    x_min, x_max = min(x_test[:, 0]) - 0.5, max(x_test[:, 0]) + 0.5</span><br><span class="line">    y_min, y_max = min(x_test[:, 1]) - 0.5, max(x_test[:, 1]) + 0.5</span><br><span class="line">    xx, yy = np.meshgrid(np.arange(x_min, x_max, 0.01), np.arange(y_min, y_max, 0.01))</span><br><span class="line">    x_grid = np.vstack((xx.reshape(-1), yy.reshape(-1))).T</span><br><span class="line">    # 预测结果</span><br><span class="line">    y_pred = classifier.predict(x_grid).reshape(xx.shape)</span><br><span class="line">    # 绘制等高轮廓</span><br><span class="line">    plt.contourf(xx, yy, y_pred, cmap=plt.cm.cool_r)</span><br><span class="line">    # 绘制测试点</span><br><span class="line">    indexs_0 = np.argwhere(y_test == 0).squeeze()</span><br><span class="line">    indexs_1 = np.argwhere(y_test == 1).squeeze()</span><br><span class="line">    plt.scatter(x_test[indexs_0, 0], x_test[indexs_0, 1], c=&apos;r&apos;, marker=&apos;&lt;&apos;)</span><br><span class="line">    plt.scatter(x_test[indexs_1, 0], x_test[indexs_1, 1], c=&apos;g&apos;, marker=&apos;8&apos;)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure><p>实现步骤如下：</p><ol><li>加载数据</li><li>训练逻辑回归分类器</li><li>编辑网格，预测结果</li><li>绘制轮廓图以及散点图</li></ol><p><img src="/imgs/决策边界/lr_decision_boundary.png" alt></p><h3 id="基于轮廓的决策边界"><a href="#基于轮廓的决策边界" class="headerlink" title="基于轮廓的决策边界"></a>基于轮廓的决策边界</h3><h4 id="两类数据决策边界"><a href="#两类数据决策边界" class="headerlink" title="两类数据决策边界"></a>两类数据决策边界</h4><p>从上面可知，使用单线决策边界无法实现非线性数据分类，下面使用神经网络分类器实现基于轮廓的决策边界。参考上述实现，替换分类器为神经网络分类器即可</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"></span><br><span class="line"># @Time    : 19-7-18 下午9:22</span><br><span class="line"># @Author  : zj</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import numpy as np</span><br><span class="line">from sklearn.model_selection import train_test_split</span><br><span class="line">import pandas as pd</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">from nn_classifier import NN</span><br><span class="line">import warnings</span><br><span class="line"></span><br><span class="line">warnings.filterwarnings(&apos;ignore&apos;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def load_scores(data_path, shuffle=True, tsize=0.8):</span><br><span class="line">    ...</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">def draw_decision_boundary(classifier, x, y):</span><br><span class="line">    # 编辑网络，预测结果</span><br><span class="line">    x_min, x_max = min(x[:, 0]) - 0.5, max(x[:, 0]) + 0.5</span><br><span class="line">    y_min, y_max = min(x[:, 1]) - 0.5, max(x[:, 1]) + 0.5</span><br><span class="line">    xx, yy = np.meshgrid(np.arange(x_min, x_max, 0.01), np.arange(y_min, y_max, 0.01))</span><br><span class="line">    x_grid = np.vstack((xx.reshape(-1), yy.reshape(-1))).T</span><br><span class="line">    # 预测结果</span><br><span class="line">    y_pred = classifier.predict(x_grid).reshape(xx.shape)</span><br><span class="line">    # 绘制等高轮廓</span><br><span class="line">    plt.contourf(xx, yy, y_pred, cmap=plt.cm.cool_r)</span><br><span class="line">    # 绘制测试点</span><br><span class="line">    indexs_0 = np.argwhere(y == 0).squeeze()</span><br><span class="line">    indexs_1 = np.argwhere(y == 1).squeeze()</span><br><span class="line">    plt.scatter(x[indexs_0, 0], x[indexs_0, 1], c=&apos;r&apos;, marker=&apos;&lt;&apos;)</span><br><span class="line">    plt.scatter(x[indexs_1, 0], x[indexs_1, 1], c=&apos;g&apos;, marker=&apos;8&apos;)</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    scores_path = &apos;/home/zj/data/scores.csv&apos;</span><br><span class="line">    x_train, x_test, y_train, y_test = load_scores(scores_path)</span><br><span class="line"></span><br><span class="line">    # 零中心 + 单位方差</span><br><span class="line">    mu = np.mean(x_train, axis=0)</span><br><span class="line">    var = np.var(x_train, axis=0)</span><br><span class="line">    eps = 1e-8</span><br><span class="line">    x_train = (x_train - mu) / np.sqrt(var + eps)</span><br><span class="line">    x_test = (x_test - mu) / np.sqrt(var + eps)</span><br><span class="line"></span><br><span class="line">    # 训练分类器</span><br><span class="line">    classifier = NN([100], input_dim=2, num_classes=2, learning_rate=5e-2, reg=1e-3)</span><br><span class="line">    classifier.train(x_train, y_train, num_iters=20000, batch_size=256, verbose=True)</span><br><span class="line"></span><br><span class="line">    draw_decision_boundary(classifier, x_test, y_test)</span><br></pre></td></tr></table></figure><p><img src="/imgs/决策边界/nn_decision_boundary.png" alt></p><h4 id="多类数据决策边界"><a href="#多类数据决策边界" class="headerlink" title="多类数据决策边界"></a>多类数据决策边界</h4><p><code>cs231n</code>中提供了一个神经网络测试：<a href="http://cs231n.github.io/" target="_blank" rel="noopener">Putting it together: Minimal Neural Network Case Study</a>，里面实现了<code>3</code>类数据集的分类，并绘制了决策面</p><p>数据集是自定义得到的<code>3</code>类数据，每类个数为<code>100</code>，维度为<code>2</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">def load_data():</span><br><span class="line">    N = 100  # number of points per class</span><br><span class="line">    D = 2  # dimensionality</span><br><span class="line">    K = 3  # number of classes</span><br><span class="line">    X = np.zeros((N * K, D))  # data matrix (each row = single example)</span><br><span class="line">    y = np.zeros(N * K, dtype=&apos;uint8&apos;)  # class labels</span><br><span class="line">    for j in range(K):</span><br><span class="line">        ix = range(N * j, N * (j + 1))</span><br><span class="line">        r = np.linspace(0.0, 1, N)  # radius</span><br><span class="line">        t = np.linspace(j * 4, (j + 1) * 4, N) + np.random.randn(N) * 0.2  # theta</span><br><span class="line">        X[ix] = np.c_[r * np.sin(t), r * np.cos(t)]</span><br><span class="line">        y[ix] = j</span><br><span class="line">    # lets visualize the data:</span><br><span class="line">    plt.scatter(X[:, 0], X[:, 1], c=y, s=40, cmap=plt.cm.Spectral)</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line">    np.random.seed(100)</span><br><span class="line">    np.random.shuffle(X)</span><br><span class="line">    np.random.seed(100)</span><br><span class="line">    np.random.shuffle(y)</span><br><span class="line"></span><br><span class="line">    return X, y</span><br></pre></td></tr></table></figure><p>使用<code>softmax</code>分类器实现结果：</p><p><img src="/imgs/决策边界/spiral_linear.png" alt></p><p>使用<code>2</code>层神经网络（隐藏层神经元个数为<code>100</code>），学习率为<code>1e-0</code>，正则化强度为<code>1e-3</code>，共训练<code>10000</code>轮</p><p><img src="/imgs/决策边界/spiral_net.png" alt></p><h4 id="多维数据决策边界"><a href="#多维数据决策边界" class="headerlink" title="多维数据决策边界"></a>多维数据决策边界</h4><p>如果数据集维度为多维，需要进一步降维才能进行决策边界可视化。有两种方式进行降维操作：</p><blockquote><p>1.利用随机森林分类器等给特征进行重要性评分，得到2个最重要的特征，然后在散点图上绘制决策边界。<br>2.主成分分析(PCA)或线性判别分析(LDA)等降维技术可用于将N个特征嵌入到2个特征中，从而将N个特征的信息解释或减少为2个特征(n_components = 2)。然后再基于这两个特征在散点图上绘制决策边界。</p></blockquote><p>使用<code>Iris</code>数据集进行测试，其包含<code>3</code>类数据，数据维度为<code>4</code>，参考：<a href="https://www.zhujian.tech/posts/ba2ca878.html">iris数据集</a></p><p>参考<a href="https://www.zhujian.tech/posts/49729a62.html#more">主成分分析</a>，实现<code>PCA</code>降维操作，完整代码如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"></span><br><span class="line"># @Time    : 19-7-16 上午9:52</span><br><span class="line"># @Author  : zj</span><br><span class="line"></span><br><span class="line">import numpy as np</span><br><span class="line">from sklearn import utils</span><br><span class="line">from sklearn.model_selection import train_test_split</span><br><span class="line">import pandas as pd</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">import matplotlib as mpl</span><br><span class="line">from nn_classifier import NN</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def load_iris(iris_path, shuffle=True, tsize=0.8):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    加载iris数据</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    data = pd.read_csv(iris_path, header=0, delimiter=&apos;,&apos;)</span><br><span class="line"></span><br><span class="line">    if shuffle:</span><br><span class="line">        data = utils.shuffle(data)</span><br><span class="line"></span><br><span class="line">    species_dict = &#123;</span><br><span class="line">        &apos;Iris-setosa&apos;: 0,</span><br><span class="line">        &apos;Iris-versicolor&apos;: 1,</span><br><span class="line">        &apos;Iris-virginica&apos;: 2</span><br><span class="line">    &#125;</span><br><span class="line">    data[&apos;Species&apos;] = data[&apos;Species&apos;].map(species_dict)</span><br><span class="line"></span><br><span class="line">    data_x = np.array(</span><br><span class="line">        [data[&apos;SepalLengthCm&apos;], data[&apos;SepalWidthCm&apos;], data[&apos;PetalLengthCm&apos;], data[&apos;PetalWidthCm&apos;]]).T</span><br><span class="line">    data_y = np.array(data[&apos;Species&apos;])</span><br><span class="line"></span><br><span class="line">    x_train, x_test, y_train, y_test = train_test_split(data_x, data_y, train_size=tsize, test_size=(1 - tsize),</span><br><span class="line">                                                        shuffle=False)</span><br><span class="line"></span><br><span class="line">    return x_train, x_test, y_train, y_test</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def pca(X, ratio=0.99, **kwargs):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    pca降维</span><br><span class="line">    :param X: 大小为NxM，其中M是个数，N是维度，每个字段已是零均值</span><br><span class="line">    :param ratio: 表示投影均方误差和方差比值，默认为0.99,保持99%的方差</span><br><span class="line">    :param kwargs: 字典参数，如果指定了k值，则直接计算</span><br><span class="line">    :return: 降维后数据</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    N, M = X.shape[:2]</span><br><span class="line">    C = X.dot(X.T) / M</span><br><span class="line">    u, s, v = np.linalg.svd(C)</span><br><span class="line"></span><br><span class="line">    k = 1</span><br><span class="line">    if &apos;k&apos; in kwargs:</span><br><span class="line">        k = kwargs[&apos;k&apos;]</span><br><span class="line">    else:</span><br><span class="line">        while k &lt; N:</span><br><span class="line">            s_k = np.sum(s[:k])</span><br><span class="line">            s_N = np.sum(s)</span><br><span class="line">            if (s_k * 1.0 / s_N) &gt;= ratio:</span><br><span class="line">                break</span><br><span class="line">            k += 1</span><br><span class="line">    p = u.transpose()[:k]</span><br><span class="line">    y = p.dot(X)</span><br><span class="line"></span><br><span class="line">    return y, p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def draw_decision_boundary(classifier, x_test, y_test):</span><br><span class="line">    # PCA降维</span><br><span class="line">    y, p = pca(x_test, k=2)</span><br><span class="line">    # 编辑网络，预测结果</span><br><span class="line">    x_min, x_max = min(p[0]) - 0.05, max(p[0]) + 0.05</span><br><span class="line">    y_min, y_max = p[1].min() - 0.05, p[1].max() + 0.05</span><br><span class="line">    xx, yy = np.meshgrid(np.arange(x_min, x_max, 0.001), np.arange(y_min, y_max, 0.001))</span><br><span class="line">    x_grid = np.vstack((xx.reshape(-1), yy.reshape(-1))).T.dot(y)</span><br><span class="line">    y_pred = classifier.predict(x_grid).reshape(xx.shape)</span><br><span class="line">    # 绘制等高轮廓</span><br><span class="line">    plt.contourf(xx, yy, y_pred, cmap=mpl.cm.jet)</span><br><span class="line">    # 绘制测试点</span><br><span class="line">    indexs_0 = np.argwhere(y_test == 0).squeeze()</span><br><span class="line">    indexs_1 = np.argwhere(y_test == 1).squeeze()</span><br><span class="line">    indexs_2 = np.argwhere(y_test == 2).squeeze()</span><br><span class="line">    plt.scatter(p[0, indexs_0], p[1, indexs_0], c=&apos;r&apos;, marker=&apos;&lt;&apos;)</span><br><span class="line">    plt.scatter(p[0, indexs_1], p[1, indexs_1], c=&apos;g&apos;, marker=&apos;8&apos;)</span><br><span class="line">    plt.scatter(p[0, indexs_2], p[1, indexs_2], c=&apos;y&apos;, marker=&apos;*&apos;)</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    iris_path = &apos;/home/zj/data/iris-species/Iris.csv&apos;</span><br><span class="line">    x_train, x_test, y_train, y_test = load_iris(iris_path)</span><br><span class="line"></span><br><span class="line">    mu = np.mean(x_train, axis=0)</span><br><span class="line">    var = np.var(x_train, axis=0)</span><br><span class="line">    eps = 1e-8</span><br><span class="line">    x_train = (x_train - mu) / np.sqrt(var + eps)</span><br><span class="line">    x_test = (x_test - mu) / np.sqrt(var + eps)</span><br><span class="line"></span><br><span class="line">    # 训练分类器</span><br><span class="line">    classifier = NN([100, 60], input_dim=4, num_classes=3, learning_rate=1e-1, reg=1e-3)</span><br><span class="line">    classifier.train(x_train, y_train, num_iters=30000, batch_size=200, verbose=True)</span><br><span class="line"></span><br><span class="line">    draw_decision_boundary(classifier, x_test, y_test)</span><br></pre></td></tr></table></figure><p><img src="/imgs/决策边界/nn_iris.png" alt></p></div><div class="reward-container"><div>坚持原创技术分享，您的支持将鼓励我继续创作！</div> <button disable="enable" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';"> 打赏</button><div id="qr" style="display:none"><div style="display:inline-block"> <img src="/images/wechatpay.jpg" alt="zhujian 微信支付"><p>微信支付</p></div><div style="display:inline-block"> <img src="/images/alipay.jpg" alt="zhujian 支付宝"><p>支付宝</p></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> zhujian</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://www.zhujian.tech/posts/c37e79f3.html" title="决策边界">https://www.zhujian.tech/posts/c37e79f3.html</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/null" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/python/" rel="tag"># python</a> <a href="/tags/numpy/" rel="tag"># numpy</a> <a href="/tags/matplotlib/" rel="tag"># matplotlib</a> <a href="/tags/sklearn/" rel="tag"># sklearn</a> <a href="/tags/pandas/" rel="tag"># pandas</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/posts/81a57a7.html" rel="next" title="神经网络分类器"><i class="fa fa-chevron-left"></i> 神经网络分类器</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/posts/913b0c70.html" rel="prev" title="测试驱动开发">测试驱动开发<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="comments" id="gitalk-container"></div></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#什么是决策边界"><span class="nav-number">1.</span> <span class="nav-text">什么是决策边界</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#什么是超平面"><span class="nav-number">2.</span> <span class="nav-text">什么是超平面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#线性-vs-非线性"><span class="nav-number">3.</span> <span class="nav-text">线性 vs. 非线性</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#常用线性和非线性分类器"><span class="nav-number">3.1.</span> <span class="nav-text">常用线性和非线性分类器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#决策边界可视化"><span class="nav-number">4.</span> <span class="nav-text">决策边界可视化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#单线决策边界"><span class="nav-number">4.1.</span> <span class="nav-text">单线决策边界</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基于轮廓的决策边界"><span class="nav-number">4.2.</span> <span class="nav-text">基于轮廓的决策边界</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#两类数据决策边界"><span class="nav-number">4.2.1.</span> <span class="nav-text">两类数据决策边界</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#多类数据决策边界"><span class="nav-number">4.2.2.</span> <span class="nav-text">多类数据决策边界</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#多维数据决策边界"><span class="nav-number">4.2.3.</span> <span class="nav-text">多维数据决策边界</span></a></li></ol></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="zhujian" src="/images/avatar.png"><p class="site-author-name" itemprop="name">zhujian</p><div class="site-description" itemprop="description">one bite at a time</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">169</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">48</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">129</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="feed-link motion-element"><a href="/./atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/zjZSTU" title="Github &amp;rarr; https:&#x2F;&#x2F;github.com&#x2F;zjZSTU" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> Github</a></span><span class="links-of-author-item"><a href="https://blog.csdn.net/u012005313" title="CSDN &amp;rarr; https:&#x2F;&#x2F;blog.csdn.net&#x2F;u012005313" rel="noopener" target="_blank"><i class="fa fa-fw fa-book"></i> CSDN</a></span><span class="links-of-author-item"><a href="/mailto:zjzstu@gmail.com" title="Gmail &amp;rarr; mailto:zjzstu@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> Gmail</a></span><span class="links-of-author-item"><a href="/mailto:505169307@gmail.com" title="QQmail &amp;rarr; mailto:505169307@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> QQmail</a></span></div><div class="cc-license motion-element" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/null" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="https://cloud.tencent.com/" title="https:&#x2F;&#x2F;cloud.tencent.com" rel="noopener" target="_blank">腾讯云</a></li><li class="links-of-blogroll-item"> <a href="https://www.aliyun.com/" title="https:&#x2F;&#x2F;www.aliyun.com" rel="noopener" target="_blank">阿里云</a></li><li class="links-of-blogroll-item"> <a href="https://developer.android.com/" title="https:&#x2F;&#x2F;developer.android.com&#x2F;" rel="noopener" target="_blank">Android Dev</a></li><li class="links-of-blogroll-item"> <a href="https://jenkins.io/" title="https:&#x2F;&#x2F;jenkins.io&#x2F;" rel="noopener" target="_blank">Jenkins</a></li><li class="links-of-blogroll-item"> <a href="http://cs231n.github.io/" title="http:&#x2F;&#x2F;cs231n.github.io&#x2F;" rel="noopener" target="_blank">cs231n</a></li><li class="links-of-blogroll-item"> <a href="https://pytorch.org/docs/stable/index.html" title="https:&#x2F;&#x2F;pytorch.org&#x2F;docs&#x2F;stable&#x2F;index.html" rel="noopener" target="_blank">pytorch</a></li><li class="links-of-blogroll-item"> <a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/" title="https:&#x2F;&#x2F;docs.docker.com&#x2F;install&#x2F;linux&#x2F;docker-ce&#x2F;ubuntu&#x2F;" rel="noopener" target="_blank">docker</a></li></ul></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2020</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">zhujian</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-area-chart"></i></span> <span class="post-meta-item-text">站点总字数：</span> <span title="站点总字数">948k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span class="post-meta-item-text">站点阅读时长 &asymp;</span> <span title="站点阅读时长">26:20</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-bar-chart-o"></i></span> <a href="https://tongji.baidu.com/web/27249108/overview/index?siteId=13647183" rel="noopener" target="_blank">百度统计</a></div><div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.0.0</div> <span class="post-meta-divider">|</span><div class="theme-info">主题 – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.5.0</div><div class="beian"> <a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">浙ICP备 19026415号</a> <span class="post-meta-divider">|</span> <img src="/images/beian_icon.png" style="display:inline-block;text-decoration:none;height:13px"> <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33011802001748" rel="noopener" target="_blank">浙公网安备 33011802001748号</a></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span> <span class="site-uv" title="总访客量">访客数：<span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="site-pv" title="总访问量">阅读量：<span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script color="17,63,61" opacity="1" zindex="-1" count="199" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script type="text/x-mathjax-config">

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });

  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') {
          next = next.nextSibling;
        }
        if (next && next.nodeName.toLowerCase() === 'br') {
          next.parentNode.removeChild(next);
        }
      }
    });
  });

  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      element = document.getElementById(all[i].inputID + '-Frame').parentNode;
      if (element.nodeName.toLowerCase() == 'li') {
        element = element.parentNode;
      }
      element.classList.add('has-jax');
    }
  });
</script><script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML', () => {
    MathJax.Hub.Typeset();
  }, window.MathJax);
</script><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css"><script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '8f22595c6dd29c94467d',
      clientSecret: 'e66bd90ebb9aa66c562c753dec6c90ceecbd51f2',
      repo: 'guestbook',
      owner: 'zjZSTU',
      admin: ['zjZSTU'],
      id: 'beef381db7702a616ddbd974c8a898b1',
        language: '',
      distractionFreeMode: 'true'
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
</script></body></html>