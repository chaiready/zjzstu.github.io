<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.0.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="alternate" href="/./atom.xml" title="做一个幸福的人" type="application/atom+xml"><meta name="google-site-verification" content="Qr_3yqLtyErDFKHW7mE8PJz4qDUX-bf_fMLpSRckQe4"><meta name="baidu-site-verification" content="zOwIvKMV7f"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Roboto:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="/lib/pace/pace-theme-center-atom.min.css"><script src="/lib/pace/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"7.5.0",exturl:!1,sidebar:{position:"left",display:"post",offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!1,pangu:!1,algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"搜索文章",hits_empty:"我们没有找到任何搜索结果: ${query}",hits_stats:"找到约${hits}条结果（用时${time}ms）"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},translation:{copy_button:"复制",copy_success:"复制成功",copy_failure:"复制失败"},sidebarPadding:40}</script><link href="https://fonts.googleapis.com/css?family=Noto+Serif+SC|Roboto&display=swap" rel="stylesheet"><meta name="description" content="主成分分析（princial component analysis，简称PCA）是一种无监督的数据降维操作，它通过最大化方差方法来寻找低维空间，能够有效减轻计算量的同时保证处理数据有效性"><meta name="keywords" content="python,opencv,numpy,matplotlib,主成分分析"><meta property="og:type" content="article"><meta property="og:title" content="主成分分析"><meta property="og:url" content="https:&#x2F;&#x2F;www.zhujian.tech&#x2F;posts&#x2F;49729a62.html"><meta property="og:site_name" content="做一个幸福的人"><meta property="og:description" content="主成分分析（princial component analysis，简称PCA）是一种无监督的数据降维操作，它通过最大化方差方法来寻找低维空间，能够有效减轻计算量的同时保证处理数据有效性"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https:&#x2F;&#x2F;www.zhujian.tech&#x2F;imgs&#x2F;主成分分析&#x2F;mnist_origin.png"><meta property="og:image" content="https:&#x2F;&#x2F;www.zhujian.tech&#x2F;imgs&#x2F;主成分分析&#x2F;mnist_deconstruct.png"><meta property="og:image" content="https:&#x2F;&#x2F;www.zhujian.tech&#x2F;imgs&#x2F;主成分分析&#x2F;cifar_origin.png"><meta property="og:image" content="https:&#x2F;&#x2F;www.zhujian.tech&#x2F;imgs&#x2F;主成分分析&#x2F;cifar_deconstruct.png"><meta property="og:updated_time" content="2020-02-15T05:36:35.871Z"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https:&#x2F;&#x2F;www.zhujian.tech&#x2F;imgs&#x2F;主成分分析&#x2F;mnist_origin.png"><link rel="canonical" href="https://www.zhujian.tech/posts/49729a62.html"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,isPage:!1,isArchive:!1}</script><title>主成分分析 | 做一个幸福的人</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?e677aac1ac69b8826b9cfecb4e72e107";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">做一个幸福的人</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">面朝大海，春暖花开</p></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签<span class="badge">129</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类<span class="badge">48</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档<span class="badge">169</span></a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header> <a href="https://github.com/zjZSTU" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.zhujian.tech/posts/49729a62.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.png"><meta itemprop="name" content="zhujian"><meta itemprop="description" content="one bite at a time"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="做一个幸福的人"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> 主成分分析</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-06-04 11:42:44" itemprop="dateCreated datePublished" datetime="2019-06-04T11:42:44+00:00">2019-06-04</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-02-15 05:36:35" itemprop="dateModified" datetime="2020-02-15T05:36:35+00:00">2020-02-15</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/algorithm/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/programming/programming-language/" itemprop="url" rel="index"><span itemprop="name">编程语言</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/algorithm/data-learning/" itemprop="url" rel="index"><span itemprop="name">机器学习</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/programming/codebase/" itemprop="url" rel="index"><span itemprop="name">代码库</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">本文字数：</span> <span>6.2k</span></span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span>10 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><p>主成分分析（<code>princial component analysis</code>，简称<code>PCA</code>）是一种无监督的数据降维操作，它通过最大化方差方法来寻找低维空间，能够有效减轻计算量的同时保证处理数据有效性</p><a id="more"></a><p>主要参考文章<a href="https://blog.csdn.net/u012005313/article/details/50877366" target="_blank" rel="noopener">PCA数学原理</a>，里面做了生动的数学原理分析</p><p>相关线性代数、几何学以及统计学数学内容参考：</p><p><a href="https://www.zhujian.tech/posts/b905521b.html#more">概率论基础</a></p><p><a href="https://www.zhujian.tech/posts/74e95c64.html#more">线性代数基础</a></p><p>本文主要内容如下：</p><ol><li>原理解析</li><li>如何重建原始数据</li><li>如何确定$k$值</li><li>操作步骤</li><li><code>numpy</code>实现</li></ol><h2 id="原理解析"><a href="#原理解析" class="headerlink" title="原理解析"></a>原理解析</h2><ul><li>为什么要进行数据降维？</li></ul><ol><li>减少内存或磁盘存储</li><li>加快算法运行</li><li>数据可视化（<em>将多维数据将为2维或3维，实现数据可视化</em>）</li></ol><ul><li>为什么能够进行数据降维?</li></ul><p>原始数据之间存在结构相关性，某些数据的丢失不影响后续对数据的处理</p><ul><li>数据降维过程应该注意哪些？</li></ul><ol><li>保留尽可能多的原始数据内部的结构信息</li><li>处理后的数据不存在相关性</li></ol><ul><li>如何保证能够得到尽可能多的原始数据内部的结构信息？</li></ul><p>原始数据内部的结构信息不会在投影后重叠在一起，低维空间数据尽可能分散，也即使说投影后每个字段数据的<strong>方差</strong>越大越好</p><p>假设有<code>M</code>个<code>N</code>维<strong>列向量</strong>数据$X\in R^{N\times M}$，第$i$个字段数据的方差计算如下：</p><script type="math/tex;mode=display">
Var(X_{,j}) = \frac {1}{M} \sum_{j=1}^{M} (X_{ij} - \mu_{i})^{2}</script><p>$\mu_{i}$表示第$i$个字段数据的均值</p><script type="math/tex;mode=display">
\mu_{i} = \frac {1}{M} \sum_{j=1}^{M}X_{ij}</script><ul><li>如何保证处理后的数据不存在相关性</li></ul><p>投影后不同字段之间的<strong>协方差</strong>为<code>0</code>，表示不存在相关性，数据完全独立</p><p>第$i$个和第$l$个字段数据之间的协方差计算如下：</p><script type="math/tex;mode=display">
Cov(X_{i}, X_{l}) = \frac {1}{M} \sum_{j=1}^{M} X_{i,j}X_{l,j}</script><ul><li>如何计算方差和协方差?</li></ul><p>原始数据$X$有$N$维，表示有$N$个字段，计算字段之间的协方差矩阵$C\in R^{N\times N}$，对角元素表示方差，非对角元素表示协方差</p><script type="math/tex;mode=display">
C = \begin{bmatrix}
c_{11} & c_{12} & \cdots & c_{1N}\\ 
c_{21} & c_{22} & \cdots & c_{2N}\\ 
\vdots & \vdots & \vdots & \vdots\\ 
c_{N1} & c_{N2} & \cdots & c_{NN}
\end{bmatrix}
=\frac {1}{M}XX^{T}</script><p>其中$c_{ii}$表示第$i$个字段的随机变量，$c_{ij}$表示第$i$个和第$j$个字段的随机变量</p><p><strong>目标是协方差值为<code>0</code>,也就是协方差矩阵对角化</strong></p><ul><li>如何计算协方差矩阵对角化？</li></ul><p>协方差矩阵$C$是实对称矩阵，所以存在正交矩阵$Q$，能得到</p><script type="math/tex;mode=display">
Q^{-1}CQ = Q^{T}CQ = \Lambda = diag(\lambda_{1}, \lambda_{2}, ..., \lambda_{n})</script><p>其中$\lambda_{1}, \lambda_{2}, …, \lambda_{n}$为$C$的特征值</p><p>正交矩阵$Q$由特征值对应的特征向量正交化且单位化后组成，<strong>$Q$的第$j$列特征向量对应特征值$\lambda_{j}$</strong></p><p><strong>所以计算协方差矩阵的特征值和特征向量，将特征值（<em>方差</em>）从大到小排列，取前$k$个对应的特征向量（<em>列向量</em>），就是低维空间的基</strong></p><ul><li>如何执行降维操作？</li></ul><p>前$k$个特征向量（<em>转置成行向量</em>）组成的矩阵$P\in R^{k\times N}$，所以</p><script type="math/tex;mode=display">
Y = PX \in R^{k\times M}</script><p>$Y$表示数据$X$投影到矩阵$P$为基的低维空间数据</p><h2 id="需不需要数据去量纲？"><a href="#需不需要数据去量纲？" class="headerlink" title="需不需要数据去量纲？"></a>需不需要数据去量纲？</h2><p>参考：</p><p><a href="https://www.jianshu.com/p/c21c0e2c403a" target="_blank" rel="noopener">PCA填坑篇——使用PCA到底需不需要数据去量纲？</a></p><p><a href="https://www.jianshu.com/p/ae9db78ebb0f" target="_blank" rel="noopener">PCA要对数据进行预处理的原因</a></p><p>需要对原始数据去量纲，也就是让属性成为单纯一个数，去除属性单位带来的影响（比如<code>cm</code>和<code>kg</code>）</p><p>需要统一单位，所以需要对原始数据进行标准化操作，原始数据减去均值后，再除以各字段的标准差</p><p><strong>注意：在图像操作中，每个字段取值均为<code>[0-255]</code>，可以不进行去量纲操作，减去均值即可</strong></p><h2 id="如何重建原始数据"><a href="#如何重建原始数据" class="headerlink" title="如何重建原始数据"></a>如何重建原始数据</h2><p>对投影数据进行逆操作</p><script type="math/tex;mode=display">
X_{approx} = P^{T}\cdot Y  = R^{N\times k}\cdot R^{k\times M} = R^{N\times M}</script><p>需要每个字段加上均值</p><script type="math/tex;mode=display">
(X_{approx})_{i} = (X_{approx})_{i} + \mu_{i}</script><p>还需要对每个字段乘以字段标准差</p><script type="math/tex;mode=display">
(X_{approx})_{i} = (X_{approx})_{i} * \sigma_{i}</script><h2 id="如何确定-k-值"><a href="#如何确定-k-值" class="headerlink" title="如何确定$k$值"></a>如何确定$k$值</h2><p>降维目的是保证能够大幅降低维度，同时能够最大限度保持原始数据内部结构信息，通过投影均方误差来评价投影结果</p><script type="math/tex;mode=display">
\frac {1}{M} ||X - X_{approx}||^{2}</script><p>计算投影均方误差和数据集方差（已减去均值）比值，如果要保持<code>99%</code>方差</p><script type="math/tex;mode=display">
\frac {\frac {1}{M} ||X - X_{approx}||^{2}}{\frac {1}{M} ||X||^{2}} \leq 0.01</script><p>可以利用特征值来加速计算</p><script type="math/tex;mode=display">
1 - \frac {\sum_{i=1}^{K} \lambda_{i}}{\sum_{i=1}^{N} \lambda_{i}} \leq 0.01
\Rightarrow
\frac {\sum_{i=1}^{K} \lambda_{i}}{\sum_{i=1}^{N} \lambda_{i}} \geq 0.99</script><h2 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h2><p>假设有$M$条$N$维列向量数据</p><ol><li>将原始数据按列排成$N$行$M$列矩阵$X\in R^{N\times M}$</li><li>对$X$进行标准化操作（<em>每行减去均值后再除以标准差</em>）</li><li>求协方差矩阵$C=\frac {1}{M}XX^{T}$</li><li>求协方差矩阵特征值及对应的特征向量</li><li>将特征向量（<em>行向量形式</em>）按对应特征值大小从上到下排列成矩阵，取前$k$行组成矩阵$P\in R^{k\times N}$</li><li>$Y=PX = R^{k\times N}\cdot R^{N\times M}=R^{k\times M}$即为降维到$k$维后的数据</li></ol><h2 id="numpy实现"><a href="#numpy实现" class="headerlink" title="numpy实现"></a>numpy实现</h2><h3 id="特征值和特征向量计算"><a href="#特征值和特征向量计算" class="headerlink" title="特征值和特征向量计算"></a>特征值和特征向量计算</h3><p>函数<a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.eig.html" target="_blank" rel="noopener">numpy.linalg.eig</a>用于计算协方差矩阵的特征值和特征向量</p><blockquote><p>numpy.linalg.eig(a)</p></blockquote><p>输入参数$a$是方阵</p><p>返回两个数组：<code>eigenvalue、eigenvector</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; w, v = np.linalg.eig(np.diag((1,2,3)))</span><br><span class="line">&gt;&gt;&gt; w</span><br><span class="line">array([1., 2., 3.])</span><br><span class="line">&gt;&gt;&gt; v # 列向量</span><br><span class="line">array([[1., 0., 0.],</span><br><span class="line">       [0., 1., 0.],</span><br><span class="line">       [0., 0., 1.]])</span><br></pre></td></tr></table></figure><p>函数<a href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.linalg.svd.html" target="_blank" rel="noopener">numpy.linalg.svd</a>用于奇异值分解</p><blockquote><p>numpy.linalg.svd(a, full_matrices=1, compute_uv=1)</p></blockquote><ul><li>$a$是大小为$M\times N$的实矩阵或复矩阵</li><li><code>full_matrices</code>默认为<code>True</code>，表示返回值$u$和$v$大小为$M\times M$和$N\times N$；否则形状为$M\times K$和$K\times N$，其中$K = min(M,N)$</li><li><code>compute_uv</code>默认为<code>True</code>，表示是否计算<code>u/v</code></li></ul><p>返回值是<code>3</code>个数组<code>u/s/v</code>，其中<code>s</code>表示特征值并且按从大到小排列，<code>u</code>表示其对应的<strong>特征列向量</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; X</span><br><span class="line">array([[3, 0, 0],</span><br><span class="line">       [0, 1, 0],</span><br><span class="line">       [0, 0, 2]])</span><br><span class="line">&gt;&gt;&gt; u,s,v = np.linalg.svd(X)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; u # 列向量</span><br><span class="line">array([[1., 0., 0.],</span><br><span class="line">       [0., 0., 1.],</span><br><span class="line">       [0., 1., 0.]])</span><br><span class="line">&gt;&gt;&gt; s</span><br><span class="line">array([3., 2., 1.])</span><br><span class="line">&gt;&gt;&gt; v</span><br><span class="line">array([[1., 0., 0.],</span><br><span class="line">       [0., 0., 1.],</span><br><span class="line">       [0., 1., 0.]])</span><br></pre></td></tr></table></figure><p><strong><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.svd.html" target="_blank" rel="noopener">scipy.linalg.svd</a>同样实现了奇异值分解</strong></p><p><strong>注意：除以标准差时需要注意除数不能为<code>0</code></strong></p><h3 id="pca实现"><a href="#pca实现" class="headerlink" title="pca实现"></a>pca实现</h3><p>完整实现代码如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"></span><br><span class="line"># @Time    : 19-6-5 上午11:36</span><br><span class="line"># @Author  : zj</span><br><span class="line"></span><br><span class="line">import numpy as np</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">import cv2</span><br><span class="line">import os</span><br><span class="line">import time</span><br><span class="line">import warnings</span><br><span class="line"></span><br><span class="line">warnings.filterwarnings(&apos;ignore&apos;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def load_cifar_data(num, data_path):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    加载cifar数据</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    test_dir = os.path.join(data_path, &apos;test&apos;, &apos;0&apos;)</span><br><span class="line">    file_list = os.listdir(test_dir)</span><br><span class="line"></span><br><span class="line">    data_list = []</span><br><span class="line">    for i in range(num):</span><br><span class="line">        img_path = os.path.join(test_dir, file_list[i])</span><br><span class="line">        img = cv2.imread(img_path)</span><br><span class="line">        if img is not None:</span><br><span class="line">            data_list.append(img.reshape(-1))</span><br><span class="line"></span><br><span class="line">    return np.array(data_list).astype(np.uint8)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def load_mnist_data(num, data_path):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    加载mnist数据， 轮流提取每个类别的图像</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    test_dir = os.path.join(data_path, &apos;test&apos;)</span><br><span class="line"></span><br><span class="line">    data_list = []</span><br><span class="line">    for i in range(num):</span><br><span class="line">        img_path = os.path.join(test_dir, str(i % 10), &apos;%d.png&apos; % (i))</span><br><span class="line">        img = cv2.imread(img_path, cv2.IMREAD_GRAYSCALE)</span><br><span class="line">        if img is not None:</span><br><span class="line">            data_list.append(img.reshape(-1))</span><br><span class="line"></span><br><span class="line">    return np.array(data_list).astype(np.uint8)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def pca(X, ratio=0.99, **kwargs):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    pca降维</span><br><span class="line">    :param X: 大小为NxM，其中M是个数，N是维度，每个字段已是零均值</span><br><span class="line">    :param ratio: 表示投影均方误差和方差比值，默认为0.99,保持99%的方差</span><br><span class="line">    :param kwargs: 字典参数，如果指定了k值，则直接计算</span><br><span class="line">    :return: 降维后数据</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    N, M = X.shape[:2]</span><br><span class="line">    C = X.dot(X.T) / M</span><br><span class="line">    u, s, v = np.linalg.svd(C)</span><br><span class="line">    # u, s, v = linalg.svd(C)</span><br><span class="line"></span><br><span class="line">    k = 1</span><br><span class="line">    if &apos;k&apos; in kwargs:</span><br><span class="line">        k = kwargs[&apos;k&apos;]</span><br><span class="line">    else:</span><br><span class="line">        while k &lt; N:</span><br><span class="line">            s_k = np.sum(s[:k])</span><br><span class="line">            s_N = np.sum(s)</span><br><span class="line">            if (s_k * 1.0 / s_N) &gt;= ratio:</span><br><span class="line">                break</span><br><span class="line">            k += 1</span><br><span class="line">    p = u.transpose()[:k]</span><br><span class="line">    y = p.dot(X)</span><br><span class="line"></span><br><span class="line">    return y, p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def make_image(data_array, N, W, H, is_gray=False):</span><br><span class="line">    if is_gray:</span><br><span class="line">        img = np.zeros((N * H, N * W))</span><br><span class="line">    else:</span><br><span class="line">        img = np.zeros((N * H, N * W, 3))</span><br><span class="line">    for i in range(N):</span><br><span class="line">        for j in range(N):</span><br><span class="line">            if is_gray:</span><br><span class="line">                img[i * H:(i + 1) * H, j * W:(j + 1) * W] = data_array[i * N + j].reshape(H, W)</span><br><span class="line">            else:</span><br><span class="line">                img[i * H:(i + 1) * H, j * W:(j + 1) * W, :] = data_array[i * N + j].reshape(H, W, 3)</span><br><span class="line">    return img.astype(np.uint8)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    mnist_path = &apos;/home/zj/data/decompress_mnist/&apos;</span><br><span class="line">    cifar_path = &apos;/home/zj/data/decompress_cifar_10/&apos;</span><br><span class="line">    N = 7</span><br><span class="line">    W = 32</span><br><span class="line">    H = 32</span><br><span class="line">    isGray = False</span><br><span class="line"></span><br><span class="line">    # data_array = load_mnist_data(N * N, mnist_path)</span><br><span class="line">    data_array = load_cifar_data(N * N, cifar_path)</span><br><span class="line">    img1 = make_image(data_array, N, W, H, is_gray=isGray)</span><br><span class="line"></span><br><span class="line">    if N == 1:</span><br><span class="line">        mu = 0</span><br><span class="line">    else:</span><br><span class="line">        mu = np.mean(data_array, axis=0, keepdims=True)</span><br><span class="line">    data_array = data_array - mu</span><br><span class="line"></span><br><span class="line">    print(data_array.shape)</span><br><span class="line">    start = time.time()</span><br><span class="line">    y, p = pca(data_array.T, ratio=0.99)</span><br><span class="line">    end = time.time()</span><br><span class="line">    print(&apos;pca need time: %f&apos; % (end - start))</span><br><span class="line">    print(y.shape)</span><br><span class="line">    X_reduced = (p.T.dot(y)).T</span><br><span class="line">    X_reduced += mu</span><br><span class="line"></span><br><span class="line">    img2 = make_image(X_reduced, N, W, H, is_gray=isGray)</span><br><span class="line"></span><br><span class="line">    plt.figure(1)</span><br><span class="line">    if isGray:</span><br><span class="line">        plt.imshow(img1, cmap=&apos;gray&apos;)</span><br><span class="line">    else:</span><br><span class="line">        plt.imshow(img1)</span><br><span class="line">    plt.axis(&apos;off&apos;)</span><br><span class="line"></span><br><span class="line">    plt.figure(2)</span><br><span class="line">    if isGray:</span><br><span class="line">        plt.imshow(img2, cmap=&apos;gray&apos;)</span><br><span class="line">    else:</span><br><span class="line">        plt.imshow(img2)</span><br><span class="line">    plt.axis(&apos;off&apos;)</span><br><span class="line"></span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure><p>进行<code>mnist</code>图像降维，保留<code>99%</code>的方差，图像从<code>784</code>维降至<code>43</code>维</p><p>降维<code>(49, 784)</code>到<code>(49, 43)</code>耗时<code>0.088249</code>秒</p><p><img src="/imgs/主成分分析/mnist_origin.png" alt></p><p><img src="/imgs/主成分分析/mnist_deconstruct.png" alt></p><p>进行<code>cifar</code>图像降维，保留<code>99%</code>的方差，图像从<code>3072</code>维降至<code>49</code>维</p><p>降维<code>(49, 3072)</code>到<code>(49, 41)</code>耗时9.106328秒</p><p><img src="/imgs/主成分分析/cifar_origin.png" alt></p><p><img src="/imgs/主成分分析/cifar_deconstruct.png" alt></p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>参考：<a href="https://www.zhihu.com/question/47121788?sort=created" target="_blank" rel="noopener">为什么PCA不被推荐用来避免过拟合？</a></p><p>PCA是通用的数据降维操作，但在卷积神经网络处理中不推荐使用PCA作为预处理操作，因为在无监督降维过程中，一些关键结构信息会因为方差小而被处理掉</p></div><div class="reward-container"><div>坚持原创技术分享，您的支持将鼓励我继续创作！</div> <button disable="enable" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';"> 打赏</button><div id="qr" style="display:none"><div style="display:inline-block"> <img src="/images/wechatpay.jpg" alt="zhujian 微信支付"><p>微信支付</p></div><div style="display:inline-block"> <img src="/images/alipay.jpg" alt="zhujian 支付宝"><p>支付宝</p></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> zhujian</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://www.zhujian.tech/posts/49729a62.html" title="主成分分析">https://www.zhujian.tech/posts/49729a62.html</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/null" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/python/" rel="tag"># python</a> <a href="/tags/opencv/" rel="tag"># opencv</a> <a href="/tags/numpy/" rel="tag"># numpy</a> <a href="/tags/matplotlib/" rel="tag"># matplotlib</a> <a href="/tags/principal-component-analysis/" rel="tag"># 主成分分析</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/posts/74e95c64.html" rel="next" title="线性代数基础"><i class="fa fa-chevron-left"></i> 线性代数基础</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/posts/20cc7a49.html" rel="prev" title="随机失活">随机失活<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="comments" id="gitalk-container"></div></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#原理解析"><span class="nav-number">1.</span> <span class="nav-text">原理解析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#需不需要数据去量纲？"><span class="nav-number">2.</span> <span class="nav-text">需不需要数据去量纲？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#如何重建原始数据"><span class="nav-number">3.</span> <span class="nav-text">如何重建原始数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#如何确定-k-值"><span class="nav-number">4.</span> <span class="nav-text">如何确定$k$值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#操作步骤"><span class="nav-number">5.</span> <span class="nav-text">操作步骤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#numpy实现"><span class="nav-number">6.</span> <span class="nav-text">numpy实现</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#特征值和特征向量计算"><span class="nav-number">6.1.</span> <span class="nav-text">特征值和特征向量计算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pca实现"><span class="nav-number">6.2.</span> <span class="nav-text">pca实现</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#小结"><span class="nav-number">7.</span> <span class="nav-text">小结</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="zhujian" src="/images/avatar.png"><p class="site-author-name" itemprop="name">zhujian</p><div class="site-description" itemprop="description">one bite at a time</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">169</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">48</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">129</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="feed-link motion-element"><a href="/./atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/zjZSTU" title="Github &amp;rarr; https:&#x2F;&#x2F;github.com&#x2F;zjZSTU" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> Github</a></span><span class="links-of-author-item"><a href="https://blog.csdn.net/u012005313" title="CSDN &amp;rarr; https:&#x2F;&#x2F;blog.csdn.net&#x2F;u012005313" rel="noopener" target="_blank"><i class="fa fa-fw fa-book"></i> CSDN</a></span><span class="links-of-author-item"><a href="/mailto:zjzstu@gmail.com" title="Gmail &amp;rarr; mailto:zjzstu@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> Gmail</a></span><span class="links-of-author-item"><a href="/mailto:505169307@gmail.com" title="QQmail &amp;rarr; mailto:505169307@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> QQmail</a></span></div><div class="cc-license motion-element" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/null" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="https://cloud.tencent.com/" title="https:&#x2F;&#x2F;cloud.tencent.com" rel="noopener" target="_blank">腾讯云</a></li><li class="links-of-blogroll-item"> <a href="https://www.aliyun.com/" title="https:&#x2F;&#x2F;www.aliyun.com" rel="noopener" target="_blank">阿里云</a></li><li class="links-of-blogroll-item"> <a href="https://developer.android.com/" title="https:&#x2F;&#x2F;developer.android.com&#x2F;" rel="noopener" target="_blank">Android Dev</a></li><li class="links-of-blogroll-item"> <a href="https://jenkins.io/" title="https:&#x2F;&#x2F;jenkins.io&#x2F;" rel="noopener" target="_blank">Jenkins</a></li><li class="links-of-blogroll-item"> <a href="http://cs231n.github.io/" title="http:&#x2F;&#x2F;cs231n.github.io&#x2F;" rel="noopener" target="_blank">cs231n</a></li><li class="links-of-blogroll-item"> <a href="https://pytorch.org/docs/stable/index.html" title="https:&#x2F;&#x2F;pytorch.org&#x2F;docs&#x2F;stable&#x2F;index.html" rel="noopener" target="_blank">pytorch</a></li><li class="links-of-blogroll-item"> <a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/" title="https:&#x2F;&#x2F;docs.docker.com&#x2F;install&#x2F;linux&#x2F;docker-ce&#x2F;ubuntu&#x2F;" rel="noopener" target="_blank">docker</a></li></ul></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2020</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">zhujian</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-area-chart"></i></span> <span class="post-meta-item-text">站点总字数：</span> <span title="站点总字数">948k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span class="post-meta-item-text">站点阅读时长 &asymp;</span> <span title="站点阅读时长">26:20</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-bar-chart-o"></i></span> <a href="https://tongji.baidu.com/web/27249108/overview/index?siteId=13647183" rel="noopener" target="_blank">百度统计</a></div><div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.0.0</div> <span class="post-meta-divider">|</span><div class="theme-info">主题 – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.5.0</div><div class="beian"> <a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">浙ICP备 19026415号</a> <span class="post-meta-divider">|</span> <img src="/images/beian_icon.png" style="display:inline-block;text-decoration:none;height:13px"> <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33011802001748" rel="noopener" target="_blank">浙公网安备 33011802001748号</a></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span> <span class="site-uv" title="总访客量">访客数：<span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="site-pv" title="总访问量">阅读量：<span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script color="17,63,61" opacity="1" zindex="-1" count="199" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script type="text/x-mathjax-config">

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });

  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') {
          next = next.nextSibling;
        }
        if (next && next.nodeName.toLowerCase() === 'br') {
          next.parentNode.removeChild(next);
        }
      }
    });
  });

  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      element = document.getElementById(all[i].inputID + '-Frame').parentNode;
      if (element.nodeName.toLowerCase() == 'li') {
        element = element.parentNode;
      }
      element.classList.add('has-jax');
    }
  });
</script><script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML', () => {
    MathJax.Hub.Typeset();
  }, window.MathJax);
</script><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css"><script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '8f22595c6dd29c94467d',
      clientSecret: 'e66bd90ebb9aa66c562c753dec6c90ceecbd51f2',
      repo: 'guestbook',
      owner: 'zjZSTU',
      admin: ['zjZSTU'],
      id: 'c9aeb9abec66de6720dfed3199c0fd48',
        language: '',
      distractionFreeMode: 'true'
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
</script></body></html>